(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["districtDetail"],{"0718":function(t,i,e){"use strict";var a=e("3a68"),n=e.n(a);n.a},"089e":function(t,i,e){"use strict";e.r(i);var a=function(){var t=this,i=t.$createElement,a=t._self._c||i;return a("div",{ref:"wrapper",class:{IOS:t._isiOS&&t._isApp},attrs:{id:"district-detail"}},[a("div",{ref:"header",style:{backgroundImage:"url("+t.headerBgUrl+")"},attrs:{id:"header"}},[a("div",{staticClass:"header-top",style:t.paddingTop,attrs:{id:"header-top"}},[a("div",{ref:"back",staticClass:"iconfont iconlist_left",attrs:{id:"back"},on:{click:t.goBack}}),a("div",{attrs:{id:"header-title"}},[t._v("走进"+t._s(t.name))])])]),a("div",{staticClass:"header-top",class:{visible:t.fixedBackVisible},style:t.paddingTop,attrs:{id:"fixed-header-top"}},[a("div",{staticClass:"iconfont iconlist_left",attrs:{id:"fixed-back"},on:{click:t.goBack}}),a("div",{attrs:{id:"fixed-header-title"}},[t._v("走进"+t._s(t.name))])]),a("div",{attrs:{id:"main"}},[t.blocks&&t.blocks.length>0?a("div",{attrs:{id:"nav"}},t._l(t.blocks,function(i,e){return a("div",{key:"nav"+e,staticClass:"nav-item",style:t.navWidth,on:{click:function(e){return t.handleClickNav(i)}}},[a("img",{staticClass:"nav-icon",attrs:{src:i.imageUrl,alt:""}}),a("div",{staticClass:"nav-title"},[t._v(t._s(i.name))])])}),0):t._e(),a("districtBanner",{attrs:{bannerImageUrl:t.bannerImageUrl,bannerUrl:t.bannerUrl}}),t.mainVideoUrl?a("div",{style:{backgroundImage:"url("+t.mainVideoBg+")"},attrs:{id:"main-video"},on:{click:t.playMainVideo}},[a("div",{attrs:{id:"main-video-center"}},[a("img",{attrs:{id:"play-icon",src:e("c4bd"),alt:""}}),a("div",{attrs:{id:"main-video-title"}},[t._v("带你走进"+t._s(t.name))])])]):t._e(),a("div",{staticClass:"block-wrapper",attrs:{id:"introduction-wrapper"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.videoData.length>0,expression:"videoData.length > 0"}],attrs:{id:"video-wrapper"}},[t._l(t.visibleVideoCovers,function(i,n){return a("div",{directives:[{name:"lazy",rawName:"v-lazy:background-image",value:i,expression:"video",arg:"background-image"}],key:"video"+n,staticClass:"video no-placeholder-img",on:{click:function(i){return t.playVideo(t.videoData[n])}}},[a("img",{staticClass:"video-icon",attrs:{src:e("c4bd"),alt:""}})])}),a("div",{directives:[{name:"show",rawName:"v-show",value:t.videoData.length>3,expression:"videoData.length > 3"}],staticClass:"video-more video",on:{click:t.viewMoreVideo}},[t._m(0)])],2),a("div",{staticClass:"block-title"},[t._v("简介")]),a("div",{staticClass:"desc",style:{height:t.completeIntroduction?"auto":t.foldHeight},domProps:{innerHTML:t._s(t.introductionData.detailInfo)}}),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.completeIntroduction,expression:"!completeIntroduction"}],staticClass:"ellipsis"},[t._v("...")]),a("div",{staticClass:"read"},[a("div",{on:{click:t.readCompleteIntroduction}},[t._v(t._s(t.completeIntroduction?"收起":"继续阅读"))])])]),a("district-history",{staticClass:"block-wrapper",attrs:{districtData:t.introductionData,foldHeight:t.foldHeight}}),a("district-activity",{attrs:{activityImageUrl:t.activityImageUrl,activityUrl:t.activityUrl,activityName:t.activityName}}),a("div",{attrs:{id:"city-site-wrapper"}},[a("div",{staticClass:"title"},[t._v("城市名片")]),a("site-list",{attrs:{list:t.citySitesData}})],1)],1),a("build-dialog",{attrs:{isDialogVisible:t.isDialogVisible},on:{hideDialog:t.hideDialog}})],1)},n=[function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"video-more-center"},[e("div",{staticClass:"video-arrow"},[e("div",{staticClass:"iconfont iconmore_xi"})]),e("div",{staticClass:"video-more-text"},[t._v("查看更多")])])}],r=(e("a481"),e("28a5"),e("ac4d"),e("8a81"),e("ac6a"),e("7514"),e("6762"),e("2fdb"),e("7f7f"),e("ac2d")),o=e("a21f"),s=e("ffbe"),c=e("49a2"),l=e("d6a0"),d=e("f121"),u=e("809f"),v=e("f71a"),f=e("fa7a"),h=function(){var t=this,i=t.$createElement,e=t._self._c||i;return t.activityUrl?e("div",[e("div",{attrs:{id:"title"}},[t._v(t._s(t.activityName))]),e("div",{directives:[{name:"lazy",rawName:"v-lazy:background-image",value:t.activityImageUrl,expression:"activityImageUrl",arg:"background-image"}],attrs:{id:"bg"},on:{click:t.viewDetail}})]):t._e()},g=[],m={name:"district-activity",props:{activityImageUrl:String,activityUrl:String,activityName:String},data:function(){var t="https://img-pub01.visitshanghai.com.cn/app/huabohui.jpg";return{hasActivity:!1,title:"",imgUrl:t,activityData:null}},methods:{viewDetail:function(){r["a"].openNewWebView({url:this.activityUrl,isFitWindow:!1})}}},p=m,y=(e("6c90"),e("2877")),b=Object(y["a"])(p,h,g,!1,null,"428212a7",null),I=b.exports,w=e("68f8"),D=e("ca2e"),U=e("90e9"),k=d["a"].ENV_URL,S={name:"district-detail",mixins:[s["a"],s["b"],c["b"],w["a"]],data:function(){var t=this.$route.query.categoryId,i="",e="",a="",n="",r="",o=[],s="",c="",d="",u="",v="",f="",h="",g=null;if(t)i=t;else{var m=null;l["a"]?m=l["a"]:(m=localStorage.getItem(l["b"]),m=JSON.parse(m));var p=m;i=p.categoryId,e=p.name,a=p.detailId,n=p.imageUrl,d=p.videoImage,r=p.videoId,o=p.blocks;var y=p.bannerImageUrl;c=void 0===y?"":y;var b=p.bannerUrl;u=void 0===b?"":b;var I=p.activityImageUrl;v=void 0===I?"":I;var w=p.activityUrl;f=void 0===w?"":w;var D=p.activityName;h=void 0===D?"":D,g=p.vrInfo,s=d||this.clipImage(n,690,300)}return{idFromQuery:t,bannerImageUrl:c,bannerUrl:u,activityImageUrl:v,activityUrl:f,activityName:h,vrInfo:g,blocks:o,categoryId:i,name:e,videoId:r,introductionId:a,introductionData:{},citySitesData:[],completeIntroduction:!1,bgUrl:n,mainVideoUrl:"",mainVideoBg:s,foldHeight:"",videoData:[],fixedTopThreshold:0,fixedBackVisible:!1,isDialogVisible:!1,tryAgain:!1,paddingTop:{}}},components:{buildDialog:u["a"],siteList:f["a"],districtHistory:v["a"],districtActivity:I,districtBanner:D["a"]},computed:{visibleVideoCovers:function(){var t=this;return this.videoData.slice(0,3).map(function(i){return t.clipImage(i.imgUrl,150,130)})},headerBgUrl:function(){var t="http://hhh.images.visitshanghai.com.cn/app/district-chongming.png";return this.name.includes("崇明")?this.clipImage(t,750,280):this.clipImage(this.bgUrl,750,280)},navWidth:function(){var t=this.blocks.length;if(t>0){var i=t>3?2:1;return{width:"".concat((1/(t/i)*100).toFixed(2),"%")}}return{}}},created:function(){var t=this;this.getFoldHeight(),this.idFromQuery?this.getCatetoryInfo().then(this.initPageData):this.initPageData(),this._isApp&&this.getClientInfo().then(function(i){var e=i.statusBarH;t._isiOS&&e<25&&(e=25),t.paddingTop={paddingTop:"".concat(e,"px")}})},mounted:function(){this.getThreshold(),this.removeHeight(),window.addEventListener("scroll",this.handleScroll)},methods:{getCatetoryInfo:function(){var t=this;return Object(U["b"])().then(function(i){var e=i.find(function(i){return i.categoryId===t.idFromQuery});t.name=e.name;var a=e.id,n=null,r=null,o=null,s=null,c=null,l=null,d=!0,u=!1,v=void 0;try{for(var f,h=i[Symbol.iterator]();!(d=(f=h.next()).done);d=!0){var g=f.value;if(e!==g){var m=g.parentId,p=g.categoryId,y=g.name,b=p.split("-").slice(-1)[0];n||+m===a&&"1"===b&&(n=g),r||+m===a&&"2"===b&&(r=g),o||+m===a&&"3"===b&&(o=g),s||+m===a&&"活动"===y.trim()&&(s=g),c||+m===a&&"banner"===y.trim()&&(c=g),l||+m===a&&y&&"vr"===y.toLowerCase()&&(l=g)}}}catch(D){u=!0,v=D}finally{try{d||null==h.return||h.return()}finally{if(u)throw v}}t.introductionId=n.categoryId;var I=n.imageUrl;if(t.mainVideoBg=t.clipImage(I,690,300),r&&(t.videoId=r.categoryId,r.imageUrl&&(t.mainVideoBg=r.imageUrl)),o){var w=i.filter(function(t){return+t.parentId===+o.id});t.blocks=w}s&&(t.activityImageUrl=s.imageUrl,t.activityUrl=s.url,t.activityName=s.detail),c&&(t.bannerImageUrl=c.imageUrl,t.bannerUrl=c.url),l&&(t.vrInfo=l)})},addVrSite:function(){this.vrInfo&&(this.citySitesData=[{vrLink:!0,jumpType:this.vrInfo.jumpType,title:this.vrInfo.detail,url:this.vrInfo.url,imgUrl:this.vrInfo.imageUrl}])},initPageData:function(){this.getDistrictDetail(),this.getDistrictVideos(),this.getSitesData()},goBack:function(){this._isApp?this.nativeGoBack():history.go(-1)},getThreshold:function(){this.fixedTopThreshold=this.$refs.back.offsetTop},getFoldHeight:function(){var t=.50667,i=getComputedStyle(document.documentElement).fontSize,e=t*parseFloat(i);this.foldHeight="".concat(parseInt(2*e),"px")},getDistrictDetail:function(){var t=this,i={channel:1,city:4,language:7,categoryId:this.introductionId,topFlag:!0,offset:1,start:0,lat:31.233492,lon:121.505401};this.$axios.content.queryContentByOrganize(i).then(function(i){var e=i.code,a=i.data;if(0===+e){var n=a.result,r=n[0],o=r.id,s={contentId:o,lat:31.233492,lon:121.505401};t.$axios.content.queryContent(s).then(function(i){i.code;var e=i.data;t.introductionData=e,t.introductionData.simpleInfo=t.introductionData.simpleInfo.trim(),t.introductionData.cover?t.introductionData.imgUrl=t.clipImage(t.introductionData.cover,650,260):t.getImageList({item:t.introductionData,width:650,height:260,clip:!0}),t.mainVideoUrl=t.getVideoLink(t.introductionData)})}})},getDistrictVideos:function(){var t=this;this.videoId&&Object(o["c"])({vm:this}).then(function(i){var e={channel:1,city:4,language:7,categoryId:t.videoId,topFlag:!0,offset:30,start:0,lat:i.gdLatitude,lon:i.gdLongitude};t.$axios.content.queryContentByOrganize(e).then(function(i){var e=i.code,a=i.data;if(0===+e){var n=a.result;n.forEach(function(i){i.videoUrl=t.getVideoLink(i),t.getImageList({item:i,clip:!0})}),t.videoData=n}})})},getSitesData:function(){var t=this;this.addVrSite(),Object(o["b"])({vm:this}).then(function(i){var e={channel:1,city:4,language:7,categoryId:t.categoryId,topFlag:!0,offset:300,start:0,lat:i.gdLatitude,lon:i.gdLongitude};t.$axios.content.queryContentByOrganize(e).then(function(i){var e=i.code,a=i.data;if(0===+e){var n=a.result;n.forEach(function(i){i.cover?i.imgUrl=t.resizeImage(i.cover,690,280):t.getImageList({item:i,width:690,height:280}),i.lmmId=+i.simpleInfo.trim()}),t.citySitesData=t.citySitesData.concat(n)}})})},readCompleteIntroduction:function(){this.completeIntroduction=!this.completeIntroduction},playMainVideo:function(){this.mainVideoUrl&&r["a"].openVideo({videoURL:this.mainVideoUrl})},playVideo:function(t){var i=t.videoUrl;i&&r["a"].openVideo({videoURL:i})},viewMoreVideo:function(){var t={name:this.name,videos:this.videoData};localStorage.setItem(l["d"],JSON.stringify(t)),this._isApp?r["a"].openNewWebView({url:"".concat(k,"/#/district-video"),isFitWindow:!0}):this.$router.push("/district-video")},handleScroll:function(){this.fixedTopThreshold||this.tryAgain||(this.getThreshold(),this.tryAgain=!0);var t=window.pageYOffset;t>this.fixedTopThreshold?this.fixedBackVisible=!0:this.fixedBackVisible=!1},handleClickNav:function(t){var i=t.jumpType,e=t.url;e=e||"",e=e.trim().replace(/^\//,"");var a=["district-vr-list"],n=!a.find(function(t){return e.includes(t)});e?(1===+i&&(e="".concat(k,"/#/").concat(e)),r["a"].openNewWebView({url:e,isFitWindow:n})):this.isDialogVisible=!0},hideDialog:function(){this.isDialogVisible=!1}},beforeDestroy:function(){this.resetHeight(),window.removeEventListener("scroll",this.handleScroll)}},_=S,C=(e("0718"),Object(y["a"])(_,a,n,!1,null,"945c4670",null));i["default"]=C.exports},"181e":function(t,i,e){"use strict";var a=e("f4ed"),n=e.n(a);n.a},"37c8":function(t,i,e){i.f=e("2b4c")},"3a68":function(t,i,e){},"3a72":function(t,i,e){var a=e("7726"),n=e("8378"),r=e("2d00"),o=e("37c8"),s=e("86cc").f;t.exports=function(t){var i=n.Symbol||(n.Symbol=r?{}:a.Symbol||{});"_"==t.charAt(0)||t in i||s(i,t,{value:o.f(t)})}},4547:function(t,i,e){},"67ab":function(t,i,e){var a=e("ca5a")("meta"),n=e("d3f4"),r=e("69a8"),o=e("86cc").f,s=0,c=Object.isExtensible||function(){return!0},l=!e("79e5")(function(){return c(Object.preventExtensions({}))}),d=function(t){o(t,a,{value:{i:"O"+ ++s,w:{}}})},u=function(t,i){if(!n(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!r(t,a)){if(!c(t))return"F";if(!i)return"E";d(t)}return t[a].i},v=function(t,i){if(!r(t,a)){if(!c(t))return!0;if(!i)return!1;d(t)}return t[a].w},f=function(t){return l&&h.NEED&&c(t)&&!r(t,a)&&d(t),t},h=t.exports={KEY:a,NEED:!1,fastKey:u,getWeak:v,onFreeze:f}},"6c90":function(t,i,e){"use strict";var a=e("4547"),n=e.n(a);n.a},"7bbc9":function(t,i,e){var a=e("6821"),n=e("9093").f,r={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],s=function(t){try{return n(t)}catch(i){return o.slice()}};t.exports.f=function(t){return o&&"[object Window]"==r.call(t)?s(t):n(a(t))}},"809f":function(t,i,e){"use strict";var a=function(){var t=this,i=t.$createElement,a=t._self._c||i;return a("v-dialog",{attrs:{visible:t.visible},on:{"update:visible":function(i){t.visible=i}}},[a("div",{staticClass:"service-dialog"},[a("div",{staticClass:"introduction-icon"},[a("img",{staticClass:"icon",attrs:{src:e("e1bc"),alt:""}})]),a("div",{staticClass:"gap"},[t._v("建设中")]),a("p",{staticClass:"tips"},[t._v("- 敬请期待 -")]),a("div",{staticClass:"confrim-btn",on:{click:t.hideDialog}},[t._v("我知道了")])])])},n=[],r={props:{isDialogVisible:{type:Boolean}},methods:{hideDialog:function(){this.$emit("hideDialog",!1)}},computed:{visible:{get:function(){return this.isDialogVisible},set:function(t){console.log(111),!t&&this.$emit("hideDialog",!1)}}}},o=r,s=(e("181e"),e("2877")),c=Object(s["a"])(o,a,n,!1,null,"184cedd7",null);i["a"]=c.exports},"8a81":function(t,i,e){"use strict";var a=e("7726"),n=e("69a8"),r=e("9e1e"),o=e("5ca1"),s=e("2aba"),c=e("67ab").KEY,l=e("79e5"),d=e("5537"),u=e("7f20"),v=e("ca5a"),f=e("2b4c"),h=e("37c8"),g=e("3a72"),m=e("d4c0"),p=e("1169"),y=e("cb7c"),b=e("d3f4"),I=e("4bf8"),w=e("6821"),D=e("6a99"),U=e("4630"),k=e("2aeb"),S=e("7bbc9"),_=e("11e9"),C=e("2621"),V=e("86cc"),x=e("0d58"),O=_.f,N=V.f,T=S.f,E=a.Symbol,j=a.JSON,B=j&&j.stringify,F="prototype",L=f("_hidden"),P=f("toPrimitive"),$={}.propertyIsEnumerable,H=d("symbol-registry"),W=d("symbols"),z=d("op-symbols"),A=Object[F],J="function"==typeof E&&!!C.f,M=a.QObject,q=!M||!M[F]||!M[F].findChild,Q=r&&l(function(){return 7!=k(N({},"a",{get:function(){return N(this,"a",{value:7}).a}})).a})?function(t,i,e){var a=O(A,i);a&&delete A[i],N(t,i,e),a&&t!==A&&N(A,i,a)}:N,K=function(t){var i=W[t]=k(E[F]);return i._k=t,i},R=J&&"symbol"==typeof E.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof E},Y=function(t,i,e){return t===A&&Y(z,i,e),y(t),i=D(i,!0),y(e),n(W,i)?(e.enumerable?(n(t,L)&&t[L][i]&&(t[L][i]=!1),e=k(e,{enumerable:U(0,!1)})):(n(t,L)||N(t,L,U(1,{})),t[L][i]=!0),Q(t,i,e)):N(t,i,e)},G=function(t,i){y(t);var e,a=m(i=w(i)),n=0,r=a.length;while(r>n)Y(t,e=a[n++],i[e]);return t},X=function(t,i){return void 0===i?k(t):G(k(t),i)},Z=function(t){var i=$.call(this,t=D(t,!0));return!(this===A&&n(W,t)&&!n(z,t))&&(!(i||!n(this,t)||!n(W,t)||n(this,L)&&this[L][t])||i)},tt=function(t,i){if(t=w(t),i=D(i,!0),t!==A||!n(W,i)||n(z,i)){var e=O(t,i);return!e||!n(W,i)||n(t,L)&&t[L][i]||(e.enumerable=!0),e}},it=function(t){var i,e=T(w(t)),a=[],r=0;while(e.length>r)n(W,i=e[r++])||i==L||i==c||a.push(i);return a},et=function(t){var i,e=t===A,a=T(e?z:w(t)),r=[],o=0;while(a.length>o)!n(W,i=a[o++])||e&&!n(A,i)||r.push(W[i]);return r};J||(E=function(){if(this instanceof E)throw TypeError("Symbol is not a constructor!");var t=v(arguments.length>0?arguments[0]:void 0),i=function(e){this===A&&i.call(z,e),n(this,L)&&n(this[L],t)&&(this[L][t]=!1),Q(this,t,U(1,e))};return r&&q&&Q(A,t,{configurable:!0,set:i}),K(t)},s(E[F],"toString",function(){return this._k}),_.f=tt,V.f=Y,e("9093").f=S.f=it,e("52a7").f=Z,C.f=et,r&&!e("2d00")&&s(A,"propertyIsEnumerable",Z,!0),h.f=function(t){return K(f(t))}),o(o.G+o.W+o.F*!J,{Symbol:E});for(var at="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),nt=0;at.length>nt;)f(at[nt++]);for(var rt=x(f.store),ot=0;rt.length>ot;)g(rt[ot++]);o(o.S+o.F*!J,"Symbol",{for:function(t){return n(H,t+="")?H[t]:H[t]=E(t)},keyFor:function(t){if(!R(t))throw TypeError(t+" is not a symbol!");for(var i in H)if(H[i]===t)return i},useSetter:function(){q=!0},useSimple:function(){q=!1}}),o(o.S+o.F*!J,"Object",{create:X,defineProperty:Y,defineProperties:G,getOwnPropertyDescriptor:tt,getOwnPropertyNames:it,getOwnPropertySymbols:et});var st=l(function(){C.f(1)});o(o.S+o.F*st,"Object",{getOwnPropertySymbols:function(t){return C.f(I(t))}}),j&&o(o.S+o.F*(!J||l(function(){var t=E();return"[null]"!=B([t])||"{}"!=B({a:t})||"{}"!=B(Object(t))})),"JSON",{stringify:function(t){var i,e,a=[t],n=1;while(arguments.length>n)a.push(arguments[n++]);if(e=i=a[1],(b(i)||void 0!==t)&&!R(t))return p(i)||(i=function(t,i){if("function"==typeof e&&(i=e.call(this,t,i)),!R(i))return i}),a[1]=i,B.apply(j,a)}}),E[F][P]||e("32e9")(E[F],P,E[F].valueOf),u(E,"Symbol"),u(Math,"Math",!0),u(a.JSON,"JSON",!0)},ac4d:function(t,i,e){e("3a72")("asyncIterator")},d4c0:function(t,i,e){var a=e("0d58"),n=e("2621"),r=e("52a7");t.exports=function(t){var i=a(t),e=n.f;if(e){var o,s=e(t),c=r.f,l=0;while(s.length>l)c.call(t,o=s[l++])&&i.push(o)}return i}},f4ed:function(t,i,e){}}]);