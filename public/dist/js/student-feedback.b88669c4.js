(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["student-feedback"],{"35b3":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"feedback",staticClass:"feedback"},[i("div",{directives:[{name:"lazy",rawName:"v-lazy:background-image",value:t.bannerUrl,expression:"bannerUrl",arg:"background-image"}],staticClass:"banner"},[t._m(0)]),i("div",{staticClass:"content-wrap"},[t._m(1),i("div",{staticClass:"module"},[t._m(2),i("ul",{staticClass:"lists"},[i("li",{staticClass:"form-item"},[i("span",{staticClass:"label"},[t._v("姓 名")]),i("div",{staticClass:"border_1"},[i("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.formData.username,expression:"formData.username",modifiers:{trim:!0}}],attrs:{type:"text",placeholder:"请输入姓名"},domProps:{value:t.formData.username},on:{blur:[t.changeBlur,function(e){return t.$forceUpdate()}],input:[function(e){e.target.composing||t.$set(t.formData,"username",e.target.value.trim())},function(e){return t.changePpat("username")}]}})])]),i("li",{staticClass:"form-item"},[i("span",{staticClass:"label"},[t._v("学 校")]),i("div",{staticClass:"border_1"},[i("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.formData.school,expression:"formData.school",modifiers:{trim:!0}}],attrs:{type:"text",placeholder:"请输入学校"},domProps:{value:t.formData.school},on:{blur:[t.changeBlur,function(e){return t.$forceUpdate()}],input:[function(e){e.target.composing||t.$set(t.formData,"school",e.target.value.trim())},function(e){return t.changePpat("school")}]}})])]),i("li",{staticClass:"form-item"},[i("span",{staticClass:"label"},[t._v("院 系")]),i("div",{staticClass:"border_1"},[i("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.formData.department,expression:"formData.department",modifiers:{trim:!0}}],attrs:{type:"text",placeholder:"请输入院系"},domProps:{value:t.formData.department},on:{blur:[t.changeBlur,function(e){return t.$forceUpdate()}],input:[function(e){e.target.composing||t.$set(t.formData,"department",e.target.value.trim())},function(e){return t.changePpat("department")}]}})])]),t.memberInfo.mobile?t._e():i("li",{staticClass:"form-item"},[i("span",{staticClass:"label"},[t._v("手机号")]),i("div",{staticClass:"border_1"},[i("span",{staticClass:"tel-icon"},[t._v("+86")]),i("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.formData.phone,expression:"formData.phone",modifiers:{trim:!0}}],attrs:{type:"tel",placeholder:"请输入手机号"},domProps:{value:t.formData.phone},on:{blur:[t.changeBlur,function(e){return t.$forceUpdate()}],input:[function(e){e.target.composing||t.$set(t.formData,"phone",e.target.value.trim())},function(e){return t.changePpat("phone")}]}})])])])]),i("div",{staticClass:"module"},[t._m(3),i("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.formData.content,expression:"formData.content",modifiers:{trim:!0}}],staticClass:"textarea",attrs:{maxlength:"300",placeholder:"文字反馈，请在这里填写"},domProps:{value:t.formData.content},on:{blur:[t.changeBlur,function(e){return t.$forceUpdate()}],input:[function(e){e.target.composing||t.$set(t.formData,"content",e.target.value.trim())},function(e){return t.changePpat("content")}]}}),i("div",{staticClass:"upload-box"},[i("div",{staticClass:"type-name"},[t._v("添加图片")]),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.imageList.length,expression:"!imageList.length"}],staticClass:"no-upload"},[i("div",{staticClass:"img-upload-icon",on:{click:t.onFileRead}},[t._v("+")])]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.imageList.length,expression:"imageList.length"}],staticClass:"upload-list"},[t._l(t.imageList,function(e,s){return i("div",{key:s,staticClass:"img-wrap"},[i("img",{staticClass:"item",attrs:{src:e.file,alt:"upload-image"}}),i("div",{staticClass:"mask"}),i("img",{staticClass:"close",attrs:{src:a("612d"),alt:"close"},on:{click:function(e){return t.handleDelImage(s)}}})])}),i("div",{directives:[{name:"show",rawName:"v-show",value:t.imageList.length<5,expression:"imageList.length < 5"}],staticClass:"img-upload-icon",on:{click:t.onFileRead}},[t._v("+")])],2)])]),i("div",{staticClass:"module"},[t._m(4),i("ul",{staticClass:"lists"},[i("li",{staticClass:"form-item"},[i("span",{staticClass:"label"},[t._v("Email")]),i("div",{staticClass:"border_1"},[i("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.formData.email,expression:"formData.email",modifiers:{trim:!0}}],attrs:{type:"text",placeholder:"请填写邮件，方便我们与您联系"},domProps:{value:t.formData.email},on:{blur:[t.changeBlur,function(e){return t.$forceUpdate()}],input:[function(e){e.target.composing||t.$set(t.formData,"email",e.target.value.trim())},function(e){return t.changePpat("email")}]}})])]),i("li",{staticClass:"form-item"},[i("span",{staticClass:"label"},[t._v("特 长")]),i("div",{staticClass:"border_1"},[i("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.formData.speciality,expression:"formData.speciality",modifiers:{trim:!0}}],attrs:{type:"text",placeholder:"请输入"},domProps:{value:t.formData.speciality},on:{blur:[t.changeBlur,function(e){return t.$forceUpdate()}],input:[function(e){e.target.composing||t.$set(t.formData,"speciality",e.target.value.trim())},function(e){return t.changePpat("speciality")}]}})])])])]),i("div",{staticClass:"btn",on:{click:t.handleSubmit}},[t._v("提交反馈")]),i("p",{staticClass:"copyright"},[t._v("- 上海城市形象推广中心 -")])])])},s=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tips"},[a("h5",{staticClass:"title"},[t._v("亲爱的同学：")]),a("p",{staticClass:"txt"},[t._v("上海城市形象推广中心倾情打造“游上海”APP，旨在为上海市民和来沪游客，通过深度体验上海的经典与精彩，走进上海、热爱上海、宣传上海，同时也为莘莘学子提供便捷服务。希望同学们能为“游上海”APP的持续优化提供宝贵意见，共同助力建设智慧旅游城市。")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("h3",{staticClass:"title"},[a("p",{staticClass:"name"},[t._v("欢迎反馈")]),a("p",{staticClass:"shadow"},[t._v("Feedback")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",{staticClass:"name"},[t._v("您的信息"),a("span",{staticClass:"tip"},[t._v("（必填）")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",{staticClass:"name"},[t._v("反馈内容"),a("span",{staticClass:"tip"},[t._v("（必填）")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",{staticClass:"name"},[t._v("更多信息"),a("span",{staticClass:"tip"},[t._v("（选填）")])])}],n=a("75fc"),o=(a("34ef"),a("4917"),a("28a5"),a("cebc")),r=(a("5df3"),a("ac6a"),a("a481"),a("ac2d")),l=a("1879"),c=l["a"].feedbackForStudent,m={data:function(){var t="参与建设提交反馈",e="WH_Student_10004";return{trackName:t,trackCode:e,bannerUrl:"http://hhh.images.visitshanghai.com.cn/student/wenquan-bg@3x.png",imageList:[],firstSubmit:!1,formData:{username:"",school:"",department:"",phone:"",content:"",email:"",speciality:""},toastTxt:{username:"请输入姓名",school:"请输入学校",department:"请输入院系",phone:"请输入手机号",content:"请输入反馈内容"},token:"",memberInfo:{}}},methods:{changePpat:function(t){this.formData[t]=this.formData[t].replace(/[\ud800-\udbff][\udc00-\udfff]/g,"")},changeBlur:function(){this._isiOS&&setTimeout(function(){var t=document.documentElement.scrollTop||document.body.scrollTop||0;window.scrollTo(0,Math.max(t-1,0))},100)},showSchoolPicker:function(){this.refs.schoolPicker.show()},closeWebView:function(){r["a"].closeWebView()},handleSubmit:function(){var t=this;for(var e in this.$uweb.trackEvent(this.trackName+this.trackCode,"提交"),this.toastTxt){if(!this.formData[e])return void this.$toast({content:this.toastTxt[e]});if("phone"===e&&!/^1[3456789]\d{9}$/.test(this.formData[e])&&!this.memberInfo.mobile)return void this.$toast({content:"请输入正确的手机号"})}if(!this.formData.email||/^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/.test(this.formData.email)){if(r["a"].showLoading(),!this.firstSubmit){this.firstSubmit=!0;var a=[],i=[];this.imageList.length&&this.imageList.forEach(function(e){var s=new FormData;s.append("file",t.base64ToBlob(e.file));var n=t.$axios.upload.getUpload(s).then(function(t){console.log(t.fileUrl,"---------------"),i.push(t.fileUrl)}).catch(function(){r["a"].hideLoading(),t.$toast({content:t.$t("questionnaire.timeout")})});a.push(n)}),Promise.all(a).then(function(){var e=Object(o["a"])({},t.formData,{imgUrls:i});c(e).then(function(e){r["a"].hideLoading(),t.firstSubmit=!1,0===e.code&&t.$modal({maskClick:!1,content:"反馈成功， 感谢您的支持",confirmText:"确认",confirm:function(e){t.closeWebView()}})}).catch(function(e){t.firstSubmit=!1,t.$toast({content:e.msg||"服务失败"}),r["a"].hideLoading(),console.log(e)})}).catch(function(e){t.firstSubmit=!1,t.$toast({content:e.msg||"服务失败"}),r["a"].hideLoading(),console.log(e)})}}else this.$toast({content:"请输入正确的邮箱"})},base64ToBlob:function(t){t=t.replace(/\s/g,"");var e=t.split(","),a=e[0].match(/:(.*?);/)[1],i=atob(e[1]),s=i.length,n=new Uint8Array(s);while(s--)n[s]=i.charCodeAt(s);return new Blob([n],{type:a})},onFileRead:function(){var t=this;r["a"].selectImage({maxCount:5-this.imageList.length}).then(function(e){var a=e.result.imageList;a.forEach(function(e){t.imageList=[].concat(Object(n["a"])(t.imageList),[{file:"data:image/jpeg;base64,"+e.base64}])})})},handleDelImage:function(t){var e=Object(n["a"])(this.imageList);e.splice(t,1),this.imageList=e}},created:function(){var t=this;r["a"].noCallAppLoginGetInfo(function(e,a){t.memberInfo=t.getMemberInfo(e),t.memberInfo.mobile&&(t.formData.phone=t.memberInfo.mobile),t.token=a}),r["a"].setAppTitle({title:this.$t("参与建设")})}},u=m,f=(a("623f"),a("2877")),d=Object(f["a"])(u,i,s,!1,null,"1c1f5790",null);e["default"]=d.exports},"623f":function(t,e,a){"use strict";var i=a("b0cf"),s=a.n(i);s.a},b0cf:function(t,e,a){}}]);