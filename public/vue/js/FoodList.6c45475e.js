(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["FoodList"],{"0277":function(t,e,o){"use strict";var s=o("4e14"),a=o.n(s);a.a},"0f2b":function(t,e,o){},"2cab":function(t,e,o){"use strict";var s=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"yellow_star"},[o("div",{staticClass:"back1 v-md"},t._l(5,function(t){return o("div",{key:t,staticClass:"iconfont iconicon_Star"})}),0),o("div",{staticClass:"front v-md",style:"width:"+100*t.code/5+"%;"},t._l(5,function(t){return o("div",{key:t,staticClass:"iconfont iconicon_Star"})}),0)])},a=[],n={name:"yellow_star",props:["code"],data:function(){return{}},components:{},mounted:function(){},computed:{},methods:{}},i=n,r=(o("e5bd"),o("2877")),c=Object(r["a"])(i,s,a,!1,null,"1aaca8b4",null);e["a"]=c.exports},"2f21":function(t,e,o){"use strict";var s=o("79e5");t.exports=function(t,e){return!!t&&s(function(){e?t.call(null,function(){},1):t.call(null)})}},"4e14":function(t,e,o){},"55dd":function(t,e,o){"use strict";var s=o("5ca1"),a=o("d8e8"),n=o("4bf8"),i=o("79e5"),r=[].sort,c=[1,2,3];s(s.P+s.F*(i(function(){c.sort(void 0)})||!i(function(){c.sort(null)})||!o("2f21")(r)),"Array",{sort:function(t){return void 0===t?r.call(n(this)):r.call(n(this),a(t))}})},"6b7c":function(t,e,o){"use strict";var s=o("bc58"),a=o.n(s);a.a},"705d":function(t,e,o){},"74cc":function(t,e,o){"use strict";var s=o("0f2b"),a=o.n(s);a.a},b133:function(t,e,o){"use strict";o.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"foodWrapper",staticClass:"food scrollbar"},[s("top-title",{attrs:{header:t.header}}),s("header-title",{attrs:{title:t.header.name}}),s("div",{staticClass:"jing_xuan"},[s("div",{staticClass:"food-guide",style:{backgroundImage:"url(http://hhh.images.visitshanghai.com.cn/app/food/food_list_go.jpg)"},on:{click:t.toMeiWei}})]),s("search",{attrs:{fixTab:t.fixTab},on:{updateFoodList:t.updateFoodList}}),s("div",{staticClass:"food-list",class:["list-container","scrollbar",{padTopNav:t.fixTab}]},[s("div",{staticClass:"wrap-box"},t._l(t.list,function(e,o){return s("section",{key:o,staticClass:"one_business clearfix",on:{click:function(o){return t.goDetail(e)}}},[s("div",{directives:[{name:"lazy",rawName:"v-lazy:background-image",value:e.photoUrl,expression:"data.photoUrl",arg:"background-image"}],staticClass:"business_img"}),s("div",{staticClass:"business_info"},[s("section",{staticClass:"business_name"},[s("h3",{staticClass:"ell"},[t._v(t._s(e.name)+t._s(e.branchName?"("+e.branchName+")":""))])]),s("section",{staticClass:"business_code"},[s("YellowStar",{attrs:{code:e.avgRating}}),s("span",{staticClass:"v-md1"},[t._v(t._s(null==e.ugcCount?0:e.ugcCount)+"条")]),s("span",{staticClass:"v-md1"},[t._v("￥"+t._s(null==e.avgPrice?"--":e.avgPrice)+"/人")])],1),s("section",{staticClass:"business_other clearfix"},[s("div",{staticClass:"fl hiddenLine1"},[s("span",{staticClass:"other_dis"},[s("span",{staticClass:"iconfont iconicon_dingwei"}),t._v("距您"+t._s(t.formatAddr(e.distance)))]),s("span",{staticClass:"line"}),s("span",{staticClass:"other_price"},[t._v(t._s(e.address||"暂无地址"))])])])])])}),0),t.list.length>0&&!t.isLoading&&!t.hasMore?s("div",{staticClass:"loading-state"},[t._v("\n\t\t\t- 已经到底了 -\n\t\t")]):t._e(),t.list.length>0&&t.isLoading&&t.hasMore?s("div",{staticClass:"loading-state"},[t._v("\n\t\t\t正在加载数据，请稍后...\n\t\t")]):t._e(),!t.isLoading&&t.loadError?s("div",{staticClass:"loading-state"},[t._v("\n\t\t\t加载失败，请重试\n\t\t")]):t._e(),s("div",{directives:[{name:"show",rawName:"v-show",value:0==t.list.length&&!t.isLoading&&!t.loadError,expression:"list.length==0 && !isLoading && !loadError"}],staticClass:"empty"},[s("img",{attrs:{src:o("ddde")}}),s("div",{staticClass:"tips"},[t._v("暂无数据")])])])],1)},a=[],n=o("cebc"),i=(o("55dd"),o("6396")),r=o("ac2d"),c=o("55e6"),l=o("2cab"),d=o("2f62"),u=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"search"},[o("nav-header",{attrs:{curFood:t.curFood,curSort:t.sortType[t.curSort],showBar:t.showBar,showFoodType:t.showFoodType,showSortType:t.showSortType,fixTab:t.fixTab},on:{"nav-click":t.navClick}}),o("div",{directives:[{name:"show",rawName:"v-show",value:t.showFoodType,expression:"showFoodType"}],staticClass:"mask",on:{click:t.closeMask}},[o("div",{staticClass:"panel"},[o("div",{staticClass:"box scrollbar"},[o("ul",t._l(t.foodType,function(e,s){return o("li",{key:s,class:{active:e==t.curFood},on:{click:function(o){return t.choose(e,"name")}}},[t._v("\n\t\t\t\t\t\t"+t._s("美食"==e?"全部"+e:e)+"\n\t\t\t\t\t")])}),0)])])]),o("div",{directives:[{name:"show",rawName:"v-show",value:t.showSortType,expression:"showSortType"}],staticClass:"mask",on:{click:t.closeMask}},[o("div",{staticClass:"panel"},[o("div",{staticClass:"box scrollbar"},[o("ul",[o("li",{staticClass:"sort"},[t._v("排序方式")]),t._l(t.sortType,function(e,s){return o("li",{key:s,class:{active:s==t.curSort},on:{click:function(e){return t.choose(s,"sort")}}},[t._v("\n\t\t\t\t\t\t"+t._s(e)+"\n\t\t\t\t\t")])})],2)])])])],1)},h=[],f=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("header",{staticClass:"container-wrap",class:{fixTab:t.fixTab}},[o("div",{staticClass:"header-nav"},[o("div",{staticClass:"selection-panel"},[o("div",{staticClass:"result-panel"},[o("div",{staticClass:"food-type",class:{active:t.showFoodType},on:{click:function(e){return t.selectSearch("name")}}},[t._v("\n\t\t\t\t\t"+t._s("美食"==t.curFood?"全部"+t.curFood:t.curFood)+"\n\t\t\t\t\t"),o("i",{staticClass:"iconicon_down iconfont"})]),o("div",{staticClass:"sort-type",class:{active:t.showSortType},on:{click:function(e){return t.selectSearch("sort")}}},[t._v(t._s(t.curSort?t.curSort:"排序方式")+"\n\t\t\t\t\t"),o("i",{staticClass:"iconicon_down iconfont"})])])])])])},p=[],m=o("26a1"),v={name:"index",data:function(){return{}},props:{curSort:{type:String},curFood:{type:String},showFoodType:{type:Boolean},showSortType:{type:Boolean},fixTab:{type:Boolean,default:!1}},methods:{selectSearch:function(t){var e=document.querySelector(".headerTop").offsetHeight,o=document.querySelector(".topTitle").offsetHeight,s=document.querySelector(".jing_xuan").offsetHeight,a=document.querySelector(".food");Object(m["h"])(a,o-e+s),this.$emit("nav-click",{type:t})},goBack:function(){r["a"].closeWebView()}}},g=v,b=(o("0277"),o("2877")),w=Object(b["a"])(g,f,p,!1,null,"29159c50",null),y=w.exports,_=(o("ac6a"),o("7f7f"),o("d225")),S=o("b0b4"),C=function(){function t(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];Object(_["a"])(this,t),this._enableMultiple=e,this._beforeHandlers={default:[]},this._handlers={},this._afterHandlers={default:[]}}return Object(S["a"])(t,[{key:"getHandlers",value:function(t){return this._handlers[t]||[]}},{key:"on",value:function(t,e,o){o=void 0===o?this._enableMultiple:o,o?(this._handlers[t]||(this._handlers[t]=[]),this._handlers[t].push(e)):(console.warn("[common event]: event '".concat(t,"' has been used!")),this._handlers[t]=[e])}},{key:"onBefore",value:function(t,e){t=t||"default",this._beforeHandlers[t]||(this._beforeHandlers[t]=[]),this._beforeHandlers[t].push(e)}},{key:"onAfter",value:function(t,e){t=t||"default",this._afterHandlers[t]||(this._afterHandlers[t]=[]),this._afterHandlers[t].push(e)}},{key:"off",value:function(t){delete this._handlers[t]}},{key:"emit",value:function(t){for(var e=this,o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];var n=this._handlers[t]||[],i={stop:!1},r=n.length;s=s.concat([{name:t,length:r,exit:function(){i.stop=!0}}]),r&&(this._beforeHandlers[t]?n=this._beforeHandlers[t].concat(n):this._beforeHandlers.default&&(n=this._beforeHandlers.default.concat(n)),this._afterHandlers[t]?n=n.concat(this._afterHandlers[t]):this._afterHandlers.default&&(n=n.concat(this._afterHandlers.default)),n.forEach(function(t){!i.stop&&t.apply(e,s)}))}}]),t}(),T=new C(!0),F={getInstance:function(){return T}},k=["美食","本帮江浙菜","日本菜","火锅","西餐","自助餐","咖啡厅","小吃快餐","韩国料理","川菜","烧烤","小龙虾","东南亚菜","东北菜","新疆菜","云贵菜","湘菜"],L={1:"距离优先",2:"人气优先"},x=F.getInstance(),j={name:"search",data:function(){return{foodType:k,sortType:L,showFoodType:!1,showSortType:!1,curFood:k[0],curSort:"1"}},props:{fixTab:{type:Boolean,default:!1}},components:{NavHeader:y},computed:Object(n["a"])({},Object(d["b"])({showBar:function(t){return t.showBar}})),mounted:function(){this.curFood=k[this.$route.params.id-25]||k[0],this.curSort=this.$route.params.sort},watch:{showFoodType:function(t){var e=document.querySelector(".list-container");e&&(e.style.overflowY=t?"hidden":"auto")},showSortType:function(t){var e=document.querySelector(".list-container");e&&(e.style.overflowY=t?"hidden":"auto")}},methods:{navClick:function(t){"name"===t.type?this.showFoodType=!this.showFoodType:this.showSortType=!this.showSortType,"name"===t.type?this.showSortType=!1:this.showFoodType=!1,x.emit("scroll_list",4)},choose:function(t,e){var o=!0;"name"===e?(this.curFood===t&&(o=!1),this.curFood=t,this.showFoodType=!1):(this.curSort===t&&(o=!1),this.curSort=t,this.showSortType=!1),o&&this.$emit("updateFoodList",{curFood:this.curFood,curSort:this.curSort})},closeMask:function(){this.showFoodType=!1,this.showSortType=!1}}},O=j,H=(o("74cc"),Object(b["a"])(O,u,h,!1,null,"efc713a8",null)),A=H.exports,M=o("de81"),N=o("90fe"),$=o("ed08"),B=o("0436"),E=o("88d1"),q=M["a"].getFoodList,W=["美食","本帮江浙菜","日本菜","火锅","西餐","自助餐","咖啡厅","小吃快餐","韩国料理","川菜","烧烤","小龙虾","东南亚菜","东北菜","新疆菜","云贵菜","湘菜"],I={data:function(){return{list:[],isLoading:!0,loadError:!1,hasMore:!0,start:1,location:{lat:10,lon:10},formatAddr:N["b"],curFood:W[0],curSort:"1",header:{name:"美食",imageUrl:"http://hhh.images.visitshanghai.com.cn/food-banner.jpg?imageView/1/w/750/h/300"},recommendList:[],fixTab:!1}},components:{YellowStar:l["a"],Search:A,topTitle:B["a"],headerTitle:E["a"]},mounted:function(){var t=this;this.curFood=W[this.$route.params.id-25]||W[0],this.curSort=this.$route.params.sort;var e=this.$refs.foodWrapper;e.addEventListener("scroll",this.onScroll),c["a"].sourceType?this.getLocation(function(){t.fetchGoodList(),t.fetchList()}):(this.fetchGoodList(),this.fetchList(!1))},computed:Object(n["a"])({},Object(d["b"])({showBar:function(t){return t.showBar}})),methods:{fetchGoodList:function(){var t=this,e=Object(n["a"])({categoryId:"6-1",offset:200},this.location);this.$axios.content.queryContentByOrganize(e).then(function(e){e.data=e.data||{},t.recommendList=e.data.result||[]}).catch(function(t){console.log(t)})},toGuide:function(){r["a"].openNewWebView({url:Object($["d"])("/food-guide"),isFitWindow:!1})},toGoodDetail:function(t){console.log(t),r["a"].openNewWebView({url:Object($["d"])("/list-detail/".concat(t.id)),isFitWindow:!1})},toMeiWei:function(){r["a"].openMiniprogram({url:"",miniProgramId:"gh_8b39fff67351"})},onBottom:function(){!this.isLoading&&this.hasMore&&this.fetchList()},resetList:function(){this.start=1},updateFoodList:function(t){this.curFood=t.curFood,this.curSort=t.curSort,this.resetList(),this.fetchList(!0)},getLocation:function(t){var e=this;r["a"].gainLocation(function(o){100===o.msgCode&&o.result&&(e.location.lat=o.result.gdLatitude,e.location.lon=o.result.gdLongitude,t&&t())},this)},goDetail:function(t){r["a"].openNewWebView({url:t.businessUrl,isFitWindow:!0})},fetchList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],o={page:this.start,type:this.curSort,size:25,categoryName:"经典粤菜"===this.curFood?"粤菜":this.curFood,lat:this.location.lat,lon:this.location.lon,direction:"1"===this.curSort?"asc":"desc"};console.log(o),this.isLoading=!0,q(o,{hideLoading:!e}).then(function(o){console.log(o),o.data?(t.isLoading=!1,t.loadError=!1,t.list=e?o.data.item:t.list.concat(o.data.item),t.hasMore=o.data.isMore,t.start++,console.log(t.list)):(t.$toast({content:"未找到您要的页面，请稍后重试："+o.code,duration:2500}),t.isLoading=!1,t.loadError=!0)}).catch(function(e){t.$toast({content:"未找到您要的页面，请稍后重试："+(e.data?e.data.code:e.code),duration:2500}),t.isLoading=!1,t.loadError=!0})},scrollTo:function(){Object(i["a"])(this.$refs.foodWrapper,0,300)},onScroll:function(t){Object(m["f"])(t);var e=t.target.scrollTop,o=document.querySelector(".headerTop").offsetHeight,s=document.querySelector(".topTitle").offsetHeight,a=document.querySelector(".jing_xuan").offsetHeight;this.fixTab=e>=s-o+a,Object(m["e"])(t.target)+Object(m["a"])().height+60>Object(m["c"])(t.target)&&this.onBottom()}}},P=I,U=(o("6b7c"),Object(b["a"])(P,s,a,!1,null,"301a3e94",null));e["default"]=U.exports},bc58:function(t,e,o){},ddde:function(t,e,o){t.exports=o.p+"img/no_order.6317e10a.png"},e5bd:function(t,e,o){"use strict";var s=o("705d"),a=o.n(s);a.a},ed08:function(t,e,o){"use strict";o.d(e,"d",function(){return i}),o.d(e,"a",function(){return r}),o.d(e,"g",function(){return c}),o.d(e,"c",function(){return l}),o.d(e,"f",function(){return d}),o.d(e,"j",function(){return p}),o.d(e,"h",function(){return g}),o.d(e,"b",function(){return b}),o.d(e,"e",function(){return w}),o.d(e,"i",function(){return y});var s=o("f121"),a=o("f76d"),n=s["a"].ENV_URL,i=function(t){return"".concat(n,"/#").concat(t)},r=function(){return new Promise(function(t,e){if(window.AMap)t(window.AMap);else{var o=document.createElement("script");o.type="text/javascript",o.async=!0,o.src="http://webapi.amap.com/maps?v=1.4.14&callback=initAMap&key=555c914c29cb33d914437914f1b79b49",o.onerror=e,document.head.appendChild(o)}window.initAMap=function(){t(window.AMap)}})};function c(t,e){"string"===typeof e?localStorage.setItem(t,e):localStorage.setItem(t,JSON.stringify(e))}function l(t){var e=localStorage.getItem(t);if("string"===typeof e)try{return JSON.parse(e)}catch(o){return e}}var d={appScheme:"metro://",downloadAppUrl:"http://anijue.bangdao-tech.com/p/q/jhbvw8xg/pages/share/index.html",packageName:"com.app.shanghai.metro",otherAppPage:"metro://qrcode"},u=Object(a["a"])(),h="",f="";"iOS"===u?(h="https://itunes.apple.com/cn/app/id1395725438",f="saicpassenger://"):h="https://marketing.saicmobility.com/mis-h5/app-download";var p={appScheme:"saicpassenger://",downloadAppUrl:h,packageName:"com.saicmobility.user",otherAppPage:f},m="",v="";"iOS"===u?(m="https://apps.apple.com/cn/app/id732618720",v="shiminyun://"):m="http://m.eshimin.com/";var g={appScheme:"shiminyun://",downloadAppUrl:m,packageName:"mobi.w3studio.apps.android.shsmy.phone",otherAppPage:v},b=["1、打开微信“乘车码”小程序，点击“开通乘车码”","2、选择优先扣费方式，并开通免密支付","3、开通成功后，日常使用“游上海”APP公交乘车码即可快捷乘车"],w=["1、下载Metro大都会App，并注册登录",'2、进入底部菜单栏"乘车"页面后，点击 “立即开通”(需要打开蓝牙)',"3、开通成功后，日常使用游上海App地铁乘车码即可快捷乘车"],y=function(t){t="string"===typeof t?t:String(t);var e=/^[\d]{17}[0-9|X|x]{1}$/;if(e.test(t)){var o=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],s=t.slice(0,17),a=t.slice(17,18);a=isNaN(parseInt(a))?a.toLowerCase():parseInt(a);for(var n=0,i=0;i<17;i++)n=(n+=parseInt(s.charAt(i))*o[i])%11;var r=[1,0,"X",9,8,7,6,5,4,3,2],c="X"===r[n]?r[n].toLowerCase():r[n];return a===c?{code:0,msg:t}:{code:0,msg:"你输入的身份证号码格式不对!"}}return{code:0,msg:"你输入的身份证号码格式不对,请重新输入!"}}}}]);