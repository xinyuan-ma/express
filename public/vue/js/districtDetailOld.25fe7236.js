(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["districtDetailOld"],{2212:function(t,i,e){},"80bb":function(t,i,e){"use strict";var a=e("2212"),n=e.n(a);n.a},bf05:function(t,i){t.exports="data:image/png;base64,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"},de8f:function(t,i,e){"use strict";e.r(i);var a=function(){var t=this,i=t.$createElement,a=t._self._c||i;return a("div",{attrs:{id:"district-detail"}},[a("div",{style:{backgroundImage:"url("+t.bgUrl+")"},attrs:{id:"header"},on:{click:t.playMainVideo}},[a("div",{attrs:{id:"header-title"}},[t._v("带你走进"+t._s(t.name))]),t.mainVideoUrl?a("img",{attrs:{id:"play-icon",src:e("bf05"),alt:""}}):t._e()]),a("div",{attrs:{id:"main"}},[a("div",{staticClass:"block-wrapper",attrs:{id:"introduction-wrapper"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.videoData.length>0,expression:"videoData.length > 0"}],attrs:{id:"video-wrapper"}},[t._l(t.visibleVideoCovers,function(i,n){return a("div",{directives:[{name:"lazy",rawName:"v-lazy:background-image",value:i,expression:"video",arg:"background-image"}],key:"video"+n,staticClass:"video no-placeholder-img",on:{click:function(i){return t.playVideo(t.videoData[n])}}},[a("img",{staticClass:"video-icon",attrs:{src:e("c4bd"),alt:""}})])}),a("div",{directives:[{name:"show",rawName:"v-show",value:t.videoData.length>3,expression:"videoData.length > 3"}],staticClass:"video-more video",on:{click:t.viewMoreVideo}},[t._m(0)])],2),a("div",{staticClass:"block-title"},[t._v("简介")]),a("div",{staticClass:"desc",style:{height:t.completeIntroduction?"auto":t.foldHeight},domProps:{innerHTML:t._s(t.introductionData.detailInfo)}}),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.completeIntroduction,expression:"!completeIntroduction"}],staticClass:"ellipsis"},[t._v("...")]),a("div",{staticClass:"read"},[a("div",{on:{click:t.readCompleteIntroduction}},[t._v(t._s(t.completeIntroduction?"收起":"继续阅读"))])])]),a("districtBanner",{staticClass:"district-banner",attrs:{bannerImageUrl:t.bannerImageUrl,bannerUrl:t.bannerUrl}}),a("district-history",{staticClass:"block-wrapper",attrs:{districtData:t.introductionData,foldHeight:t.foldHeight}}),a("div",{attrs:{id:"city-site-wrapper"}},[a("div",{staticClass:"title"},[t._v("城市名片")]),a("site-list",{attrs:{list:t.citySitesData}})],1)],1)])},n=[function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"video-more-center"},[e("div",{staticClass:"video-arrow"},[e("div",{staticClass:"iconfont iconmore_xi"})]),e("div",{staticClass:"video-more-text"},[t._v("查看更多")])])}],o=(e("ac6a"),e("28a5"),e("7514"),e("7f7f"),e("ac2d")),r=e("a21f"),d=e("ffbe"),s=e("49a2"),c=e("d6a0"),l=e("f121"),u=e("f71a"),v=e("fa7a"),g=e("ca2e"),m=e("90e9"),h=l["a"].ENV_URL,f={name:"district-detail",mixins:[d["a"],d["b"],s["b"]],components:{districtHistory:u["a"],siteList:v["a"],districtBanner:g["a"]},data:function(){var t=this.$route.query.categoryId,i="",e="",a="",n="",o="",r="",d="",s="",l=null,u=null;if(t)i=t;else{c["a"]?u=c["a"]:(u=localStorage.getItem(c["b"]),u=JSON.parse(u));var v=u;i=v.categoryId,e=v.name,a=v.detailId,n=v.imageUrl,o=v.videoId,l=v.vrInfo;var g=v.bannerId;r=void 0===g?"":g;var m=v.bannerImageUrl;d=void 0===m?"":m;var h=v.bannerUrl;s=void 0===h?"":h,n=this.resizeImage(n,750)}return{idFromQuery:t,categoryId:i,name:e,videoId:o,introductionId:a,vrInfo:l,bannerId:r,bannerImageUrl:d,bannerUrl:s,introductionData:{},citySitesData:[],completeIntroduction:!1,bgUrl:n,mainVideoUrl:"",foldHeight:"",videoData:[]}},computed:{visibleVideoCovers:function(){var t=this;return this.videoData.slice(0,3).map(function(i){return t.clipImage(i.imgUrl,150,130)})}},created:function(){var t=this;this.idFromQuery?this.getCatetoryInfo().then(function(){t.setTitle(),t.initPageData()}):(this.setTitle(),this.initPageData())},mounted:function(){this.getFoldHeight(),this.removeHeight()},methods:{setTitle:function(){o["a"].setAppTitle({title:this.name})},getCatetoryInfo:function(){var t=this;return Object(m["b"])().then(function(i){var e=i.find(function(i){return i.categoryId===t.idFromQuery});t.name=e.name;var a=i.find(function(t){return+t.parentId===e.id&&"1"===t.categoryId.split("-").slice(-1)[0]}),n=i.find(function(t){return+t.parentId===e.id&&"2"===t.categoryId.split("-").slice(-1)[0]}),o=i.find(function(t){return+t.parentId===e.id&&"banner"===t.name}),r=i.find(function(t){return+t.parentId===e.id&&t.name&&"vr"===t.name.toLowerCase()});t.introductionId=a.categoryId,n&&(t.videoId=n.categoryId),o&&(t.bannerImageUrl=o.imageUrl,t.bannerUrl=o.url),r&&(t.vrInfo=r);var d=a.imageUrl;t.bgUrl=t.clipImage(d,750)})},getFoldHeight:function(){var t=.50667,i=getComputedStyle(document.documentElement).fontSize,e=t*parseFloat(i);this.foldHeight="".concat(parseInt(2*e),"px")},initPageData:function(){this.getDistrictDetail(),this.getDistrictVideos(),this.getSitesData()},getDistrictDetail:function(){var t=this,i={channel:1,city:4,language:7,categoryId:this.introductionId,topFlag:!0,offset:1,start:0,lat:31.233492,lon:121.505401};this.$axios.content.queryContentByOrganize(i).then(function(i){var e=i.code,a=i.data;if(0===+e){var n=a.result,o=n[0],r=o.id,d={contentId:r,lat:31.233492,lon:121.505401};t.$axios.content.queryContent(d).then(function(i){i.code;var e=i.data;t.introductionData=e,t.introductionData.simpleInfo=t.introductionData.simpleInfo.trim(),t.introductionData.cover?t.introductionData.imgUrl=t.clipImage(t.introductionData.cover,650,260):t.getImageList({item:t.introductionData,width:650,height:260,clip:!0}),t.mainVideoUrl=t.getVideoLink(t.introductionData)})}})},getDistrictVideos:function(){var t=this;this.videoId&&Object(r["c"])({vm:this}).then(function(i){var e={channel:1,city:4,language:7,categoryId:t.videoId,topFlag:!0,offset:30,start:0,lat:i.gdLatitude,lon:i.gdLongitude};t.$axios.content.queryContentByOrganize(e).then(function(i){var e=i.code,a=i.data;if(0===+e){var n=a.result;n.forEach(function(i){i.videoUrl=t.getVideoLink(i),t.getImageList({item:i,clip:!0})}),t.videoData=n}})})},getSitesData:function(){var t=this;this.addVrSite(),Object(r["b"])({vm:this}).then(function(i){var e={channel:1,city:4,language:7,categoryId:t.categoryId,topFlag:!0,offset:300,start:0,lat:i.gdLatitude,lon:i.gdLongitude};t.$axios.content.queryContentByOrganize(e).then(function(i){var e=i.code,a=i.data;if(0===+e){var n=a.result;n.forEach(function(i){i.cover?i.imgUrl=t.resizeImage(i.cover,690,280):t.getImageList({item:i,width:690,height:280})}),t.citySitesData=t.citySitesData.concat(n)}})})},addVrSite:function(){this.vrInfo&&(this.citySitesData=[{vrLink:!0,jumpType:this.vrInfo.jumpType,title:this.vrInfo.detail,url:this.vrInfo.url,imgUrl:this.vrInfo.imageUrl}])},readCompleteIntroduction:function(){this.completeIntroduction=!this.completeIntroduction},playMainVideo:function(){this.mainVideoUrl&&o["a"].openVideo({videoURL:this.mainVideoUrl})},playVideo:function(t){var i=t.videoUrl;i&&o["a"].openVideo({videoURL:i})},viewMoreVideo:function(){var t={name:this.name,videos:this.videoData};localStorage.setItem(c["d"],JSON.stringify(t)),o["a"].openNewWebView({url:"".concat(h,"/#/district-video"),isFitWindow:!0})}},beforeDestroy:function(){this.resetHeight()}},p=f,I=(e("80bb"),e("2877")),A=Object(I["a"])(p,a,n,!1,null,"0c46d0a2",null);i["default"]=A.exports}}]);