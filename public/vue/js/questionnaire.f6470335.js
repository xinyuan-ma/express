(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["questionnaire"],{"12e7":function(t,e,i){},"23f4":function(t,e,i){"use strict";var n=i("12e7"),s=i.n(n);s.a},3148:function(t,e,i){t.exports=i.p+"img/icon-camera.5d1b42f0.png"},3979:function(t,e,i){},"5da2":function(t,e){t.exports="data:image/png;base64,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"},"64cc":function(t,e,i){"use strict";var n=i("aafc"),s=i.n(n);s.a},"81dd":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"opinion-page"},[t._m(0),t.feedBackType?n("quesFeedBack",{attrs:{title:"您认为游上海App最满意的方面（可多选）",list:t.goods,type:"goods"},on:{setActiveIndex:t.selectOption}}):t._e(),t.feedBackType?n("quesFeedBack",{attrs:{title:"您认为游上海App最需改进的方面（可多选）",list:t.weaks,type:"weaks"},on:{setActiveIndex:t.selectOption}}):t._e(),n("div",{staticClass:"question-desc"},[n("div",{staticClass:"desc-title"},[t._v("反馈内容")]),n("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.content,expression:"content",modifiers:{trim:!0}}],attrs:{placeholder:t.$t("questionnaire.content"),maxlength:"300"},domProps:{value:t.content},on:{blur:[t.handleBlur,function(e){return t.$forceUpdate()}],input:[function(e){e.target.composing||(t.content=e.target.value.trim())},t.inputEmoji]}})]),n("div",{staticClass:"upload-wrapper"},[n("div",{staticClass:"desc-title"},[t._v("图片反馈")]),n("div",{directives:[{name:"show",rawName:"v-show",value:!t.imageList.length,expression:"!imageList.length"}],staticClass:"no-upload"},[n("div",{staticClass:"img",on:{click:t.onFileRead}},[n("div",{staticClass:"add-icon"})])]),n("div",{directives:[{name:"show",rawName:"v-show",value:t.imageList.length,expression:"imageList.length"}],staticClass:"upload-list"},[t._l(t.imageList,function(e,s){return n("div",{key:s,staticClass:"img-wrap"},[n("img",{staticClass:"item",attrs:{src:e.file,alt:"upload-image"}}),n("div",{staticClass:"mask"}),n("img",{staticClass:"close",attrs:{src:i("612d"),alt:"close"},on:{click:function(e){return t.handleDelImage(s)}}})])}),n("div",{directives:[{name:"show",rawName:"v-show",value:t.imageList.length<5,expression:"imageList.length < 5"}],staticClass:"img-wrap",on:{click:t.onFileRead}},[n("div",{staticClass:"add-icon"})])],2)]),n("div",{staticClass:"tip"},[t.userId?n("p",[t._v("提交反馈后，即可参与抽奖活动，奖品丰富（豪华酒店住宿、热门景点门票等）")]):n("p",[t._v("您提交反馈并成为注册用户，即可参与抽奖活动，奖品丰富（豪华酒店住宿、热门景点门票等）")])]),t.userId?n("button",{staticClass:"submit-btn",on:{click:t.handleSubmit}},[t._v(t._s(t.$t("questionnaire.quesSubmit")))]):n("div",{staticClass:"btn-group"},[n("button",{staticClass:"submit-btn",on:{click:function(e){return t.handleSubmitRegister("register")}}},[t._v("\n\t\t\t"+t._s(t.$t("questionnaire.submitRegister"))+"\n\t\t")]),n("button",{staticClass:"submit-btn",on:{click:function(e){return t.handleSubmit("noRegister")}}},[t._v(t._s(t.$t("questionnaire.submitNoRegister"))+"\n\t\t")])])],1)},s=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"banner"},[i("div",{staticClass:"banner-img"}),i("div",{staticClass:"banner-title"},[i("span",{staticClass:"left-title"},[t._v("一机游上海 精彩在指尖")])]),i("div",{staticClass:"banner-product"},[i("div",{staticClass:"li"},[i("span",[t._v("便捷出行  一站出游")])]),i("div",{staticClass:"li"},[i("span",[t._v("权威资讯  智慧服务")])]),i("div",{staticClass:"li"},[i("span",[t._v("品牌直供  超值惠民")])])]),i("div",{staticClass:"banner-intro"},[t._v("此版本为试运行，您的意见和反馈将对“游上海”App的体验提升带来很大的帮助，非常感谢！")])])}],a=(i("5df3"),i("34ef"),i("4917"),i("28a5"),i("75fc")),o=(i("ac6a"),i("a481"),i("ac2d")),c=i("1879"),r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"evaluation"},[i("div",{staticClass:"title"},[t._v(t._s(t.title))]),i("ul",t._l(t.list,function(e,n){return i("li",{key:n,class:{"txt-center":n%3==1,"txt-right":n%3==2}},[i("div",{class:{active:e.show},on:{click:function(i){return t.choose(e,n)}}},[t._v(t._s(e.value)+"\n\t\t\t\t"),e.show?i("span",{staticClass:"ok-circle"}):t._e()])])}),0)])},l=[],u={name:"quesFeedBack",data:function(){return{opinionList:[],activeIndex:-1}},props:{type:{type:String},list:{type:Array,default:function(){return[]}},title:{type:String}},mounted:function(){},methods:{choose:function(t,e){this.list[e].show=!this.list[e].show,this.list[e].show?this.opinionList.push(this.list[e].value):this.opinionList.splice(this.opinionList.indexOf(this.list[e].value),1),this.$emit("setActiveIndex",{activeList:this.opinionList,type:this.type})}}},d=u,p=(i("64cc"),i("2877")),m=Object(p["a"])(d,r,l,!1,null,"2de8c9fc",null),h=m.exports,v=i("90fe"),f=c["a"].submitOpinion1,g={name:"detail",data:function(){return{content:"",username:"",phone:"",imageList:[],firstSubmit:!1,deviceId:"",appVersion:"",feedBackType:!1,qst1:[],qst2:[],goods:[{value:"出行便捷",id:1,show:!1},{value:"出游方便",id:2,show:!1},{value:"资讯全面",id:3,show:!1},{value:"预订体验",id:4,show:!1},{value:"产品丰富",id:7,show:!1},{value:"优惠力度",id:8,show:!1}],weaks:[{value:"操作体验",id:1,show:!1},{value:"界面优化",id:2,show:!1},{value:"资讯内容",id:3,show:!1},{value:"优惠力度",id:4,show:!1},{value:"系统稳定",id:7,show:!1},{value:"丰富产品",id:8,show:!1}],goodActiveIndex:-1,weakActiveIndex:-1,userId:""}},components:{quesFeedBack:h},created:function(){var t=this;o["a"].sourceType()&&o["a"].noCallAppLoginGetInfo(function(e){t.userId=e.userId,console.log("noCallAppLoginGetInfo",e)})},mounted:function(){var t=this,e="";this.$route.query.type?(e="意见反馈",this.feedBackType=!0):e="在线投诉",o["a"].setAppTitle({title:e}),o["a"].getClientInfo(function(e){t.deviceId=e.result.deviceId,t.appVersion=e.result.appVersion}),window.addEventListener("resize",function(){if("TEXTAREA"===document.activeElement.tagName){clearTimeout(t);var t=setTimeout(function(){document.activeElement.scrollIntoViewIfNeeded()},100)}})},methods:{inputEmoji:function(){var t=/[\ud800-\udbff][\udc00-\udfff]/g;this.content=this.content.replace(t,"")},selectOption:function(t){"goods"===t.type?this.qst1=t.activeList:this.qst2=t.activeList},handleBlur:function(){window.scrollTo(0,0)},handleOversize:function(t){this.$toast({content:this.$t("questionnaire.tooBig")})},onFileRead:function(){var t=this;o["a"].selectImage({maxCount:5-this.imageList.length}).then(function(e){var i=e.result.imageList;i.forEach(function(e){t.imageList=[].concat(Object(a["a"])(t.imageList),[{file:"data:image/jpeg;base64,"+e.base64}])})})},base64ToBlob:function(t){t=t.replace(/\s/g,"");var e=t.split(","),i=e[0].match(/:(.*?);/)[1],n=atob(e[1]),s=n.length,a=new Uint8Array(s);while(s--)a[s]=n.charCodeAt(s);return new Blob([a],{type:i})},handleDelImage:function(t){var e=Object(a["a"])(this.imageList);e.splice(t,1),this.imageList=e},handleSubmitRegister:function(){var t=this;this.validate()||(this.$uweb.trackEvent("提交并注册WH_reg_10001","点击"),o["a"].callAppLogin(function(e){e.token&&t.handleSubmit()}))},handleSubmit:function(t){var e=this;if("noRegister"===t&&this.$uweb.trackEvent("提交暂不注册WH_noreg_10001","点击"),!this.validate()){var i=[],n=[];this.imageList.length&&this.imageList.forEach(function(t){var s=new FormData;s.append("file",e.base64ToBlob(t.file));var a=e.$axios.upload.getUpload(s,{showLoading:!0}).then(function(t){n.push(t.fileUrl)}).catch(function(){o["a"].hideLoading(),e.$toast({content:e.$t("questionnaire.timeout")})});i.push(a)}),this.firstSubmit||(this.firstSubmit=!0,Promise.all(i).then(function(){var t={appName:"BGSH_CHINA",content:e.content,imgUrls:n,name:e.username,contact:e.phone,deviceId:e.deviceId||"",version:e.appVersion||"",qst1:e.qst1&&e.qst1.join(","),qst2:e.qst2&&e.qst2.join(","),userId:e.userId,type:e.feedBackType?2:1},i=Object(v["h"])("memberId");i&&"undefined"!==i&&(t.mebId=i),f(t,{showLoading:!0}).then(function(t){o["a"].hideLoading(),e.firstSubmit=!1,0===t.code&&e.$router.replace({path:"/questionnairSucc"})}).catch(function(t){e.firstSubmit=!1,e.$toast({content:t.msg})})}).catch(function(t){e.firstSubmit=!1,e.$toast({content:t})}))}},validate:function(){return this.feedBackType&&0===this.qst1.length?(this.$toast({content:this.$t("questionnaire.questionsEmpty1")}),!0):this.feedBackType&&0===this.qst2.length?(this.$toast({content:this.$t("questionnaire.questionsEmpty2")}),!0):this.content?!!(this.content&&this.content.length<10)&&(this.$toast({content:this.$t("questionnaire.contentLess")}),!0):(this.$toast({content:this.$t("questionnaire.quesContentEmpty")}),!0)}},beforeDestroy:function(){window.removeEventListener("resize",function(){})}},A=g,w=(i("9835"),Object(p["a"])(A,n,s,!1,null,"0a8e5024",null));e["default"]=w.exports},"866a":function(t,e,i){},9835:function(t,e,i){"use strict";var n=i("3979"),s=i.n(n);s.a},aafc:function(t,e,i){},aecd:function(t,e,i){"use strict";var n=i("866a"),s=i.n(n);s.a},d2b5:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAA6ZJREFUaAXVmr1v00AYxutWQqQSQylL1aEM5WNBLEVlBFWIrah7ByRU/gBmhs5dijrzP7RMlYqATBTUDnQLahcGPoSoKlFBoQKF3+PY5pzYiX22E/uVnsR3vvd9n8d39p0vcYZysGazWSPMHXAbXAXTYAycA7JjcAQOQAO8As8dxznhezAG6TFwH6yDHyCtyUe+iiGx/TGSjYLH4DvIyxRLMUcLU0HwEfAQfAJFmWIrx0iuQgg4CXZAv0y5JnMRQaBZUORVj7soyjmbSQQBFsFJXIY+1Cv3opUIOfaBYNIUsSKcKHVEVdfVwdmo8wOo+0XOW8wbb9tzdwiAvG6eHTDR3njA5c/kv4GIjyaPYbMAeT2+NkDZyIumOG14HFV2LSSAmgdgpnWqlJ/iJo6BBUMIZZoFtVYp49UPCHOgoTTNUPqpSrMHHlEuO3lxFkdxdc3tAa6+FlMfgL96bJ1N9vmXZrZTv62vVrdT9MKR3wP3qLAh/wQ/Db3LYA8ktTc0vAiU8ylIa/IT55bRA1rWprU/OJwxYoxTfpcgyGvaBBeL4/MJfKKarLu5OVMDNut5Bb3kC9A35V4iQuQ9nxkFsjBxrinpvIWz76IrPp5QRBT5Cfzf+8EsvuclYNXC0XRJIqII8uKwKgGbJhvL424i4sg3LHOZbpsSsG/WZDiOExHcsN6YzzpsTIr7DqVvBA6NY3NMpzzWo3SO5/NhlB+5NAlpR+JK1HmLukMJ+I1j8Di0CNLuEinCI1+nseaMvOzUn8jyCqg4WqOcRgRUXe77QBKgaTkv2ybQXYZQR0xvWM1xPs2M3YvXsQRoxywP6yCvYQOC+6sAEe5aSEvorBZJnqB18KJAEQfqAe1VZrFu5HXDXgdFiWhkXUpsc3WTPufj5ok9Ytiau5TIspibMrsOFr0mqSgR1yzZu4u5YW4sPdq2TCIJj/Uy8tVvK/Ic10G353zHcKL9F2BjW+LuzwPPLCLoLWwN4lrP62W7DrqR57RrEvESH135CxyvtapTf7qc83ilTJ05BwfNM/9fKekKzQUrOQTuV4gVj/OQ2wPKSndWe1sFRVrDLEtMyW3Z4+rSDHpAJXpBN6Z2DMq6O7cLt5sI0BPQtZAA1SCiupu7EoA67f4uAG1pl8XEZcHjFuLkzwOhShpqH34pVDnYwpLHKR0LhlN1f2LypSKiuj/yGSKq+zOrIaK6P3T7IvTNkKrmXw1MEZ6QUvzZo2MiayeapEyvDOzvNv8A2eWA7D6q8l8AAAAASUVORK5CYII="},e149:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"opinion-page"},[t.feedBackType?n("feedBack",{on:{selectOption:t.selectOption}}):t._e(),n("div",{staticClass:"question-desc"},[n("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.content,expression:"content",modifiers:{trim:!0}}],attrs:{placeholder:t.$t("questionnaire.content"),maxlength:"200"},domProps:{value:t.content},on:{blur:[t.handleBlur,function(e){return t.$forceUpdate()}],input:function(e){e.target.composing||(t.content=e.target.value.trim())}}})]),n("div",{staticClass:"upload-wrapper"},[n("div",{directives:[{name:"show",rawName:"v-show",value:!t.imageList.length,expression:"!imageList.length"}],staticClass:"no-upload"},[n("img",{attrs:{src:i("3148"),alt:"upload"},on:{click:t.onFileRead}}),n("span",[t._v(t._s(t.$t("questionnaire.upload")))])]),n("div",{directives:[{name:"show",rawName:"v-show",value:t.imageList.length,expression:"imageList.length"}],staticClass:"upload-list"},[t._l(t.imageList,function(e,s){return n("div",{key:s,staticClass:"img-wrap"},[n("img",{staticClass:"item",attrs:{src:e.file,alt:"upload-image"}}),n("div",{staticClass:"mask"}),n("img",{staticClass:"close",attrs:{src:i("d2b5"),alt:"close"},on:{click:function(e){return t.handleDelImage(s)}}})])}),n("div",{directives:[{name:"show",rawName:"v-show",value:t.imageList.length<5,expression:"imageList.length < 5"}],staticClass:"img-wrap"},[n("img",{staticClass:"upload",attrs:{src:i("5da2"),alt:"upload"},on:{click:t.onFileRead}})])],2)]),n("div",{staticClass:"contact"},[n("span",{staticClass:"label"},[t._v(t._s(t.$t("questionnaire.name")))]),n("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.username,expression:"username",modifiers:{trim:!0}}],attrs:{type:"text",placeholder:t.$t("questionnaire.username")},domProps:{value:t.username},on:{blur:[t.handleBlur,function(e){return t.$forceUpdate()}],input:function(e){e.target.composing||(t.username=e.target.value.trim())}}})]),n("div",{staticClass:"contact"},[n("span",{staticClass:"label"},[t._v(t._s(t.$t("questionnaire.phoneNum")))]),n("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.phone,expression:"phone",modifiers:{trim:!0}}],attrs:{type:"text",placeholder:t.$t("questionnaire.phone")},domProps:{value:t.phone},on:{blur:[t.handleBlur,function(e){return t.$forceUpdate()}],input:function(e){e.target.composing||(t.phone=e.target.value.trim())}}})]),n("button",{staticClass:"submit-btn",on:{click:t.handleSubmit}},[t._v(t._s(t.$t("questionnaire.submit")))])],1)},s=[],a=(i("5df3"),i("34ef"),i("4917"),i("28a5"),i("75fc")),o=(i("ac6a"),i("ac2d")),c=i("1879"),r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"feedBack"},[i("p",{staticClass:"transportation"},[t._v("\n\t\t您要反馈的问题 （多选）\n\t")]),i("div",{staticClass:"optionContent flex-between"},t._l(t.accommodations,function(e,n){return i("span",{key:n,staticClass:"option",class:{active:e.show},on:{click:function(e){return t.choice(n)}}},[t._v(t._s(e.value))])}),0)])},l=[],u={name:"feedBack",data:function(){return{accommodations:[{value:"功能问题",show:!1,id:1},{value:"产品设计",show:!1,id:2},{value:"加载缓慢",show:!1,id:3},{value:"内容缺陷",show:!1,id:4},{value:"商户问题",show:!1,id:5},{value:"其他",show:!1,id:6}],opinionList:[]}},mounted:function(){},methods:{choice:function(t){this.accommodations[t].show=!this.accommodations[t].show,this.accommodations[t].show?this.opinionList.push(this.accommodations[t].value):this.opinionList.splice(this.opinionList.indexOf(this.accommodations[t].value),1),this.$emit("selectOption",this.opinionList)}}},d=u,p=(i("23f4"),i("2877")),m=Object(p["a"])(d,r,l,!1,null,"97796324",null),h=m.exports,v=i("90fe"),f=c["a"].submitOpinion,g={name:"detail",data:function(){return{content:"",username:"",phone:"",imageList:[],firstSubmit:!1,deviceId:"",appVersion:"",feedBackType:!1,questions:[]}},components:{feedBack:h},mounted:function(){var t=this;o["a"].noCallAppLoginGetInfo(function(e){var i=t.getMemberInfo(e).mobile||t.getMemberInfo(e).virtualMobile;t.phone=i||""});var e="";this.$route.query.type?(e="意见反馈",this.feedBackType=!0):e="在线投诉",o["a"].setAppTitle({title:e}),o["a"].getClientInfo(function(e){t.deviceId=e.result.deviceId,t.appVersion=e.result.appVersion})},methods:{selectOption:function(t){console.log(t),this.questions=t},handleBlur:function(){window.scrollTo(0,0)},handleOversize:function(t){this.$toast({content:this.$t("questionnaire.tooBig")})},onFileRead:function(){var t=this;o["a"].selectImage({maxCount:5-this.imageList.length}).then(function(e){var i=e.result.imageList;i.forEach(function(e){t.imageList=[].concat(Object(a["a"])(t.imageList),[{file:"data:image/jpeg;base64,"+e.base64}])})})},base64ToBlob:function(t){var e=t.split(","),i=e[0].match(/:(.*?);/)[1],n=atob(e[1]),s=n.length,a=new Uint8Array(s);while(s--)a[s]=n.charCodeAt(s);return new Blob([a],{type:i})},handleDelImage:function(t){var e=Object(a["a"])(this.imageList);e.splice(t,1),this.imageList=e},handleSubmit:function(){var t=this;if(!this.firstSubmit)if(this.feedBackType&&0===this.questions.length)this.$toast({content:this.$t("questionnaire.questionsEmpty")});else if(this.content)if(this.content&&this.content.length<10)this.$toast({content:this.$t("questionnaire.contentLess")});else if(this.username)if(this.phone){o["a"].showLoading();var e=[],i=[];this.imageList.length&&this.imageList.forEach(function(n){var s=new FormData;s.append("file",t.base64ToBlob(n.file));var a=t.$axios.upload.getUpload(s).then(function(t){i.push(t.fileUrl)}).catch(function(){o["a"].hideLoading(),t.$toast({content:t.$t("questionnaire.timeout")})});e.push(a)}),Promise.all(e).then(function(){var e={appName:"BGSH_CHINA",desc:t.content,imgUrls:i,name:t.username,contact:t.phone,deviceId:t.deviceId||"",version:t.appVersion||"",questions:t.questions,type:t.feedBackType?2:1},n=Object(v["h"])("memberId");n&&"undefined"!==n&&(e.mebId=n),f(e).then(function(e){o["a"].hideLoading(),0===e.code&&(t.firstSubmit=!0,t.$toast({content:t.$t("questionnaire.success")}),setTimeout(function(){o["a"].closeWebView()},2e3)),500===e.code&&t.$toast({content:"Server Error"})})}).catch(function(t){console.log(t)})}else this.$toast({content:this.$t("questionnaire.phoneEmpty")});else this.$toast({content:this.$t("questionnaire.nameEmpty")});else this.$toast({content:this.$t("questionnaire.contentEmpty")})}}},A=g,w=(i("aecd"),Object(p["a"])(A,n,s,!1,null,"c4ce70f0",null));e["default"]=w.exports}}]);