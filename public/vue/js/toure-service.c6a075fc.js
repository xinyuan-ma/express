(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["toure-service"],{2486:function(t,e,i){"use strict";var n=i("d225"),o=i("b0b4"),s=(i("4917"),!1);try{var a=Object.defineProperty({},"passive",{get:function(){s=!0}});window.addEventListener("test-passive",null,a)}catch(L){}var r=s,c=i("b4f0"),d=1,l=2,h=3,u=4,p=5,v="dropstart",f="dropmove",m="dropend",g="dropupstart",_="dropupend",w={container:".drop-down-container",dropMax:200,damping:1.15,duration:300,autoBack:!0,disable:!1},y=Object.prototype.hasOwnProperty,b=function(t,e){return y.call(t,e)},k=window.navigator.appVersion.match(/iphone/gi),S=function(){function t(e,i){Object(n["a"])(this,t);var o=parseInt(getComputedStyle(document.getElementsByTagName("html")[0],null).fontSize);function s(t){return t*o/75}if(this._opts=Object.assign(w,i||{}),this._opts.dropMax=s(this._opts.dropMax),this._el="string"===typeof e?document.querySelector(e):e,!this._el)throw new Error("drop-down components can not find element !");this._container=this._el.querySelector(this._opts.container),this.translateY=0,this.duration=0,this._status=d,this._canDrop=!1,this._canMove=!0,this._isTouch=!1,this._events={},this._dropStartOnce=!0,this._startY=0,this._moveY=0,this._changeY=0,this._init()}return Object(o["a"])(t,[{key:"_init",value:function(){this._initEvent()}},{key:"_initEvent",value:function(){this._el.addEventListener("touchstart",this,!!r&&{passive:!0}),document.addEventListener("touchmove",this,!1),document.addEventListener("touchend",this,!!r&&{passive:!0}),this._container.addEventListener("webkitTransitionEnd",this,!1),this._container.addEventListener("transitionend",this,!1)}},{key:"_eventDropStart",value:function(t){this._isTouch=!0,this._startY=t.touches[0].clientY}},{key:"_eventDropMove",value:function(t){if(this._canMove&&!this._opts.disable&&this._isTouch)if(this._changeY=t.touches[0].clientY-this._startY,this._moveY=this._changeY,console.log("dropdown",this._el.className),this._el.scrollTop<=0&&this._changeY>0){if(this._canDrop=!0,k&&t.preventDefault(),this._dropStartOnce&&(this._status=d,this.emit(v),this._dropStartOnce=!1),this._isTransition(!1),this._setTranslateY(this._moveY/this._opts.damping),!this._dropStartOnce){this._status=l;var e=this.translateY/this._opts.dropMax;this.emit(f,e)}this.translateY===this._opts.dropMax&&(this._status=h,this.emit(m))}else this._canDrop=!1,this._status=d}},{key:"_eventDropEnd",value:function(t){if(this._isTouch=!1,this._canMove){this._opts.autoBack&&this.dropBack();var e=this._status;this._status=u,this._dropStartOnce=!0;var i=e===h;i&&!this._opts.autoBack&&(this._canMove=!1),this.emit(g,i)}}},{key:"_transitionEnd",value:function(t){this._canDrop=!1,this._canMove=!0,this._status=p,this._isTransition(!1),Object(c["b"])(!1),this.emit(_)}},{key:"_setTranslateY",value:function(t){this.translateY=t/3,this.translateY=this.translateY>this._opts.dropMax?this._opts.dropMax:this.translateY;var e=this._container.style;e.webkitTransform=e.MozTransform=e.OTransfrom=e.msTransform=e.tranform="translate3d(0, ".concat(this.translateY,"px, 0)")}},{key:"_isTransition",value:function(t){var e=this._container.style;this.duration=t?this._opts.duration:0,e.webkitTransitionDuration=e.MozTransitionDuration=e.msTransitionDuration=e.OTransitionDuration=e.transitionDuration=this.duration+"ms"}},{key:"handleEvent",value:function(t){switch(t.type){case"touchstart":this._eventDropStart(t);break;case"touchmove":this._eventDropMove(t);break;case"touchend":this._eventDropEnd(t);break;case"webkitTransitionEnd":case"transitionend":this._transitionEnd(t);break}}},{key:"dropBack",value:function(t){if(this._isTransition(!0),this._setTranslateY(0),"function"===typeof t){var e=function e(){t(),this.off(_,e)};this.on(_,e)}}},{key:"getStatus",value:function(){return this._status}},{key:"disabled",value:function(){this._opts.disable=!0}},{key:"enabled",value:function(){this._opts.disable=!1}},{key:"on",value:function(t,e){return b(this._events,t)||(this._events[t]=[]),this._events[t].push(e),this}},{key:"off",value:function(t,e){if(b(this._events,t)){var i=this._events[t].indexOf(e);-1!==i&&this._events[t].splice(i,0)}return this}},{key:"emit",value:function(t){var e=this._events;if(b(this._events,t))for(var i=0,n=e[t].length,o=Array.prototype.slice.call(arguments,1);i<n;i++)e[t][i].apply(this,o);return this}},{key:"destroyed",value:function(){this._el.removeEventListener("touchstart",this),document.removeEventListener("touchmove",this),document.removeEventListener("touchend",this,!1),this._container.removeEventListener("webkitTransitionEnd",this),this._container.removeEventListener("transitionend",this)}}]),t}(),T=S;function D(){}e["a"]={inserted:function(t,e){t._option=e.value.option||{},t._dropDown=new T(t,t._option);var i=e.value.dropStart||D,n=e.value.dropMove||D,o=e.value.dropUpStart||D,s=e.value.dropUpEnd||D;t._dropDown.on(v,function(e){return i(t._dropDown,e)}),t._dropDown.on(f,function(e){return n(t._dropDown,e)}),t._dropDown.on(g,function(e){return o(t._dropDown,e)}),t._dropDown.on(_,function(e){return s(t._dropDown,e)})},unbind:function(t){t._dropDown.destroyed()}}},"49fd":function(t,e,i){"use strict";var n=i("d7b6"),o=i.n(n);o.a},b4fb:function(t,e,i){"use strict";i.r(e);var n={};i.r(n),i.d(n,"dropDownStart",function(){return f}),i.d(n,"dropDownMove",function(){return m}),i.d(n,"dropUpStart",function(){return g});var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"stopScrollSelf",rawName:"v-stopScrollSelf"}],ref:"service",staticClass:"tour-service"},[t.list.length>0?n("div",{staticClass:"drop-down-fixed detail-drop-down-follow"},[n("p",[t._v(t._s(t.dropDownInfo))])]):t._e(),n("scroll-list",{ref:"hotelWrapper",attrs:{heights:t.scrollHeights,remain:t.remain,enabled:!1},on:{toBottom:t.onBottom,scrolling:function(e){return t.onScroll(e)}}},[n("header-title",{directives:[{name:"show",rawName:"v-show",value:!t._isWeixin,expression:"!_isWeixin"}],attrs:{show:!0,title:t.header.name}}),n("top-title",{staticClass:"top-img",attrs:{header:t.header}}),n("div",{staticClass:"paddingT20"},t._l(t.list,function(e,i){return n("div",{key:i,staticClass:"list",on:{click:function(i){return t.openDetail(e)}}},[n("div",{directives:[{name:"lazy",rawName:"v-lazy:backgroundImage",value:e.fileUrl,expression:"data.fileUrl",arg:"backgroundImage"}],staticClass:"bg-img"}),n("div",{staticClass:"title hiddenLine2"},[t._v(t._s(e.name))]),n("div",{staticClass:"info"},[e.openTime?n("div",{staticClass:"time"},[n("div",{staticClass:"img iconfont iconicon_shijian"}),n("span",[t._v(t._s(e.openTime))])]):t._e(),n("div",{staticClass:"distance"},[n("div",{staticClass:"img iconfont iconicon_dingwei"}),n("span",[t._v("距您"+t._s(t.formatAddr(e.distance)))])])])])}),0),t.list.length>0&&!t.isLoading&&!t.hasMore?n("div",{staticClass:"loading-state"},[t._v("\n\t\t\t- 已经到底了 -\n\t\t")]):t._e(),t.list.length>0&&t.isLoading&&t.hasMore?n("div",{staticClass:"loading-state"},[t._v("\n\t\t\t正在加载数据，请稍后...\n\t\t")]):t._e(),!t.isLoading&&t.loadError?n("div",{staticClass:"loading-state"},[t._v("\n\t\t\t加载失败，请重试\n\t\t")]):t._e(),n("div",{directives:[{name:"show",rawName:"v-show",value:0==t.list.length&&!t.isLoading&&!t.loadError,expression:"list.length==0 && !isLoading && !loadError"}],staticClass:"empty"},[n("img",{attrs:{src:i("ddde")}}),n("div",{staticClass:"tips"},[t._v("暂无数据")])])],1)],1)},s=[],a=i("cebc"),r=i("ac2d"),c=i("ed08"),d=i("90fe"),l=i("88d1"),h=i("0436"),u=(i("c5f6"),{props:{heights:{type:Array,required:!0},remain:{type:Number,default:10},enabled:{type:Boolean,default:!0}},delta:{start:0,end:0,total:0,keeps:0,paddingTop:0,paddingBottom:0,reserve:6},methods:{handleScroll:function(t){var e=this.$el.scrollTop;this.$emit("scrolling",t),this.enabled?this.updateZone(e):this.updateZoneNormally(e)},updateZoneNormally:function(t){var e=this.$el.scrollHeight,i=this.$el.clientHeight;0===t?this.$emit("toTop"):t+i+5>=e&&this.$emit("toBottom")},findOvers:function(t){for(var e=this.$options.delta,i=0,n=this.heights.length,o=this.heights[0],s=Math.floor(e.reserve/2);i<n;i++){if(!(t>=o))break;o+=this.heights[i+1]}return i>s-1?i-s:0},updateZone:function(t){var e=this.$options.delta,i=this.findOvers(t);!t&&e.total&&this.$emit("toTop");var n=i||0,o=n+e.keeps,s=this.heights.reduce(function(t,e){return t+e});t&&t+this.$el.clientHeight>=s&&(n=e.total-e.keeps,o=e.total-1,this.$emit("toBottom")),e.start=n,e.end=o,this.$forceUpdate()},filter:function(t){var e=this.$options.delta;t||(t=[],e.start=0);var i=t.filter(function(t,i){return i>=e.start&&i<=e.end}),n=this.heights.slice(0,e.start),o=this.heights.slice(e.end+1);return e.total=t.length,e.paddingTop=n.length?n.reduce(function(t,e){return t+e}):0,e.paddingBottom=o.length?o.reduce(function(t,e){return t+e}):0,i}},beforeMount:function(){if(this.enabled){var t=this.remain,e=this.$options.delta;e.start=0,e.end=t+e.reserve-1,e.keeps=t+e.reserve}},render:function(t){var e=this.enabled?this.filter(this.$slots.default):this.$slots.default,i=this.$options.delta;return t("div",{class:{"scroll-container":1},style:{display:"block","overflow-y":"auto",height:"100%",position:"relative"},on:{"&scroll":this.handleScroll}},[t("div",{style:{display:"block","padding-top":i.paddingTop+"px","padding-bottom":i.paddingBottom+"px"}},e)])}}),p=u,v=i("2486");function f(){this.dropDownInfo=""}function m(t,e){this.dropDownInfo=e>=.7?"松开刷新":"下拉刷新"}function g(){var t=this;"松开刷新"===this.dropDownInfo&&(this.resetHotelList(),this.findServiceList(this.$route.query)),setTimeout(function(){t.dropDownInfo=""},100)}var _=i("6396"),w=10,y={data:function(){return{remain:10,dropDownOption:{container:"div",dropType:"fixed",dropMax:240},isLoading:!0,hasMore:!0,scrollHeights:[],loadError:!1,dropDownInfo:"",formatAddr:d["b"],list:[],organizeId:121,location:{lat:31.24916171,lon:121.48789949},startNum:1,header:{imageUrl:"http://hhh.images.visitshanghai.com.cn/tour_service.jpg",name:"旅游服务",detail:"游客服务信息"}}},components:{ScrollList:p,headerTitle:l["a"],topTitle:h["a"]},mounted:function(){var t=this;r["a"].sourceType()?r["a"].gainLocation(function(e){t.location.lat=1*e.result.gdLatitude||31.24916171,t.location.lon=1*e.result.gdLongitude||121.48789949,console.log(t.location,"data111111"),t.findServiceList(!0)}):this.findServiceList(!0)},directives:{dropDown:v["a"]},methods:Object(a["a"])({},n,{onBottom:function(){!this.isLoading&&this.hasMore&&this.findServiceList()},resetHotelList:function(){this.list=[],this.startNum=1},openDetail:function(t){console.log(t.uuid),r["a"].openNewWebView({url:Object(c["d"])("/ziXunDetail/".concat(t.uuid)),isFitWindow:!1})},findServiceList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isLoading=!0;var i=Object(a["a"])({channel:1,city:4,lableId:69==this.organizeId?10:"",language:7,size:w,organizeId:69==this.organizeId?"":this.organizeId,page:this.startNum},this.location);this.$axios.content.queryTourService(i,{hideLoading:!e}).then(function(i){if(console.log(i),i.data){var n=i.data.item||[];n=n.map(function(e){return e.fileUrl=t.imgCover(e.fileUrl,750,360,2),e}),t.list=e?n:t.list.concat(n),t.isLoading=!1,t.loadError=!1,t.hasMore=i.data.isMore,console.log(t.list),t.hasMore&&(t.startNum=t.startNum+1)}else t.$toast({content:"服务器错误："+i.code,duration:2500}),t.hasMore=!1,t.isLoading=!1}).catch(function(e){t.$toast({content:"服务器错误："+(e.data?e.data.code:e.code),duration:2500}),t.loadError=!0,t.isLoading=!1,console.log(e)})},scrollTo:function(){Object(_["a"])(this.$refs.hotelWrapper.$el,0,300)},onScroll:function(t){var e=document.getElementsByClassName("topTitle")[0],i=document.querySelector(".headerTop"),n=e.offsetHeight,o=t.target.scrollTop,s=n-i.offsetHeight;o<n&&(i.style.opacity=o/s),o>=s&&(i.style.opacity=1)}})},b=y,k=(i("49fd"),i("2877")),S=Object(k["a"])(b,o,s,!1,null,"233b6e7e",null);e["default"]=S.exports},d7b6:function(t,e,i){},ddde:function(t,e,i){t.exports=i.p+"img/no_order.6317e10a.png"},ed08:function(t,e,i){"use strict";i.d(e,"d",function(){return a}),i.d(e,"a",function(){return r}),i.d(e,"g",function(){return c}),i.d(e,"c",function(){return d}),i.d(e,"f",function(){return l}),i.d(e,"j",function(){return v}),i.d(e,"h",function(){return g}),i.d(e,"b",function(){return _}),i.d(e,"e",function(){return w}),i.d(e,"i",function(){return y});var n=i("f121"),o=i("f76d"),s=n["a"].ENV_URL,a=function(t){return"".concat(s,"/#").concat(t)},r=function(){return new Promise(function(t,e){if(window.AMap)t(window.AMap);else{var i=document.createElement("script");i.type="text/javascript",i.async=!0,i.src="http://webapi.amap.com/maps?v=1.4.14&callback=initAMap&key=555c914c29cb33d914437914f1b79b49",i.onerror=e,document.head.appendChild(i)}window.initAMap=function(){t(window.AMap)}})};function c(t,e){"string"===typeof e?localStorage.setItem(t,e):localStorage.setItem(t,JSON.stringify(e))}function d(t){var e=localStorage.getItem(t);if("string"===typeof e)try{return JSON.parse(e)}catch(i){return e}}var l={appScheme:"metro://",downloadAppUrl:"http://anijue.bangdao-tech.com/p/q/jhbvw8xg/pages/share/index.html",packageName:"com.app.shanghai.metro",otherAppPage:"metro://qrcode"},h=Object(o["a"])(),u="",p="";"iOS"===h?(u="https://itunes.apple.com/cn/app/id1395725438",p="saicpassenger://"):u="https://marketing.saicmobility.com/mis-h5/app-download";var v={appScheme:"saicpassenger://",downloadAppUrl:u,packageName:"com.saicmobility.user",otherAppPage:p},f="",m="";"iOS"===h?(f="https://apps.apple.com/cn/app/id732618720",m="shiminyun://"):f="http://m.eshimin.com/";var g={appScheme:"shiminyun://",downloadAppUrl:f,packageName:"mobi.w3studio.apps.android.shsmy.phone",otherAppPage:m},_=["1、打开微信“乘车码”小程序，点击“开通乘车码”","2、选择优先扣费方式，并开通免密支付","3、开通成功后，日常使用“游上海”APP公交乘车码即可快捷乘车"],w=["1、下载Metro大都会App，并注册登录",'2、进入底部菜单栏"乘车"页面后，点击 “立即开通”(需要打开蓝牙)',"3、开通成功后，日常使用游上海App地铁乘车码即可快捷乘车"],y=function(t){t="string"===typeof t?t:String(t);var e=/^[\d]{17}[0-9|X|x]{1}$/;if(e.test(t)){var i=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],n=t.slice(0,17),o=t.slice(17,18);o=isNaN(parseInt(o))?o.toLowerCase():parseInt(o);for(var s=0,a=0;a<17;a++)s=(s+=parseInt(n.charAt(a))*i[a])%11;var r=[1,0,"X",9,8,7,6,5,4,3,2],c="X"===r[s]?r[s].toLowerCase():r[s];return o===c?{code:0,msg:t}:{code:0,msg:"你输入的身份证号码格式不对!"}}return{code:0,msg:"你输入的身份证号码格式不对,请重新输入!"}}}}]);